<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Discovery | SocialSpace</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/discovery.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <header class="main-header">
        <div class="logo">SocialSpace</div>
        <nav class="platform-nav">
            <div class="nav-item active" onclick="setPlatform('all')">All Platforms</div>
            <div class="nav-item" onclick="setPlatform('instagram')">Instagram</div>
            <div class="nav-item" onclick="setPlatform('youtube')">YouTube</div>
            <div class="nav-item" onclick="setPlatform('twitter')">Twitter</div>
            <div class="nav-item" onclick="setPlatform('tiktok')">TikTok</div>
        </nav>
    </header>

    <nav class="domain-nav">
        <button onclick="loadDomain('Tech')">Tech</button>
        <button onclick="loadDomain('Fitness')">Fitness</button>
        <button onclick="loadDomain('Gaming')">Gaming</button>
        <button onclick="loadDomain('Education')">Education</button>
        <button onclick="loadDomain('Cooking')">Cooking</button>
        <button onclick="loadDomain('Finance')">Finance</button>
    </nav>

    <main id="content-area">
        <div id="welcome-screen" class="centered">
            <h1 id="welcome-msg">Welcome, {{ username }}</h1>
            <p>Select a domain above to explore top performing content</p>
        </div>
        
        <div id="creator-grid" class="creator-grid" style="display: none;">
            </div>
    </main>

    <script>
        async function loadDomain(domain) {
            // Hide welcome message and show the grid
            document.getElementById('welcome-screen').style.display = 'none';
            const grid = document.getElementById('creator-grid');
            grid.style.display = 'flex'; // Flex used for horizontal scroll layout
            grid.innerHTML = '<p class="loading-text">Fetching top creators...</p>';

            try {
                const response = await fetch(`/api/creators/${domain}`);
                const data = await response.json();
                
                // Map data to the new vertical background-image card style
                grid.innerHTML = data.map(c => `
                    <div class="creator-card" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0.1), rgba(0,0,0,0.9)), url('https://picsum.photos/seed/${c.name}/400/700');">
                        <div class="card-content">
                            <div class="platform-tag">${c.platform}</div>
                            <h2 class="creator-name">${c.name}</h2>
                            <p class="famous-work">Featured: ${c.video}</p>
                            <div class="card-footer">
                                <div class="stats">
                                    <span>üëÅÔ∏è ${c.views}</span>
                                    <span>‚ù§Ô∏è ${c.likes}</span>
                                </div>
                                <div class="plus-btn">+</div>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (e) {
                grid.innerHTML = '<p>No data found for this domain.</p>';
            }
        }

        function setPlatform(platform) {
            // UI logic for platform highlighting
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if(item.innerText.toLowerCase().includes(platform)) {
                    item.classList.add('active');
                }
            });
        }
    </script>
</body>
</html>